
async = require 'async'
log = require 'node-log'
util = require 'util'; dump = (obj) -> log.info util.inspect(obj)

spec = {}
spec.buildScenarios = require('spex').load 'spec.services.buildScenarios'
spec.buildTest = require('spex').load 'spec.services.buildTest'
#spec.runTest = spex.load 'spec.services.runTest'

# a **Spec** is a specification describing some important feature of your system
# a Spec consists of **Scenarios** that the specification confirms the validity of

#which in turn consist of a description & block of code

class Spec
  status: 'notrun'

  constructor: (@name, specDSL, @isCoffee, done) ->

    @scenarios = spec.buildScenarios specDSL
    @testCode = spec.buildTest @scenarios, true

  pass: (scenarioId) -> @scenarios[ scenarioId ].pass()
  fail: (scenarioId, err) -> @scenarios[ scenarioId ].fail err

module.exports = Spec

## TEST #functional

should = require 'should'

#>> Given some spec code

code = ">> Given some spec code\nfoo = 'foo'"

#>> When you create a new Spec

mySpec = new Spec 'myspec', code, true
mySpec.should.be.an.instanceof Spec
mySpec.scenarios.length.should.equal 1

