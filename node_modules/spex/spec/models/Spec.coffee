spex = require "spex"
spec = {}
spec.buildScenarios = spex.load 'spec.services.buildScenarios'
spec.buildTest = spex.load 'spec.services.buildTest'
#spec.runTest = spex.load 'spec.services.runTest'

# a **Spec** is a specification describing some important feature of your system
# a Spec consists of **Scenarios** that the specification confirms the validity of

#which in turn consist of a description & block of code

class Spec
  status: 'notrun'

  constructor: (@name, specDSL, @isCoffee, done) ->
    @scenarios = spec.buildScenarios specDSL
    @testCode = spec.buildTest @scenarios, @isCoffee

  pass: (scenarioId) ->
    @scenarios[ scenarioId ].status = 'pass'
  fail: (scenarioId, err) ->
    @scenarios[ scenarioId ].status = 'fail'
    @scenarios[ scenarioId ].error = err


module.exports = Spec

## TEST #functional

should = require 'should'

#>> Given some spec code

code = ">> Given some spec code\nfoo = 'foo'"

#>> When you create a new Spec

mySpec = new Spec 'myspec', code, true
mySpec.should.be.an.instanceof Spec
mySpec.scenarios.length.should.equal 1

