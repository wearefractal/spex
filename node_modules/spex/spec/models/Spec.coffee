spex = require "spex"
spec = {}
spec.buildScenarios = spex.load 'spec.services.buildScenarios'
spec.buildTest = spex.load 'spec.services.buildTest'
spec.runTest = spex.load 'spec.services.runTest'

# a **Spec** is something important that happens in your system
# a spec consists of scenarios which in turn consist of a description & block of code

class Spec
  status: 'notrun'

  constructor: (@name, specDSL, @isCoffee, done) ->
    # sandbox hack: namespace self (Spec instance) for eval execution
    #global.spex.spec = @
    @scenarios = spec.buildScenarios specDSL
    @testCode = spec.buildTest @scenarios, @isCoffee
    @status = spec.runTest @testCode

#    @done?()


module.exports = Spec

## TEST #functional

should = require 'should'

#>> Given some spec code

code = ">> Given some spec code\nfoo = 'foo'"

#>> When you create a new Spec

mySpec = new Spec 'myspec', code, true
mySpec.scenarios.length.should.equal 1

